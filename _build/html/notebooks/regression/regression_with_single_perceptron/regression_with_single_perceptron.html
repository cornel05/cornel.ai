
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simple Linear Regression &#8212; AI Learning Labs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/landing_page.css?v=2ed7ac62" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/date.css?v=7762d749" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/footer.css?v=7252cef9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/font.css?v=0214559b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/regression/regression_with_single_perceptron/regression_with_single_perceptron';</script>
    <link rel="icon" href="../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Optimization" href="../../optimization/index.html" />
    <link rel="prev" title="Diamond Price Prediction" href="../diamond_price_prediction/diamond_price_prediction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">cornel.ai</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../classification/index.html">
    Classification
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Regression
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../optimization/index.html">
    Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../computer_vision/index.html">
    Computer Vision
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../pandas/index.html">
    Pandas
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../python_snippets/index.html">
    Python Snippets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/cornel05">
    GitHub: cornel05
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://cornel05.github.io/">
    cornel05.github.io
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://scikit-learn.org/">
    scikit-learn
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://pytorch.org/">
    PyTorch
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.tensorflow.org/">
    TensorFlow
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://pandas.pydata.org/">
    pandas
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://numpy.org/">
    NumPy
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://matplotlib.org/">
    Matplotlib
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://seaborn.pydata.org/">
    Seaborn
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://huggingface.co/">
    Hugging Face
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.kaggle.com/">
    Kaggle
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cornel05/AI-Learning-Labs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/dcornel05" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/cornel-ai" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../classification/index.html">
    Classification
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Regression
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../optimization/index.html">
    Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../computer_vision/index.html">
    Computer Vision
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../pandas/index.html">
    Pandas
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../python_snippets/index.html">
    Python Snippets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/cornel05">
    GitHub: cornel05
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://cornel05.github.io/">
    cornel05.github.io
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://scikit-learn.org/">
    scikit-learn
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://pytorch.org/">
    PyTorch
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.tensorflow.org/">
    TensorFlow
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://pandas.pydata.org/">
    pandas
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://numpy.org/">
    NumPy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://matplotlib.org/">
    Matplotlib
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://seaborn.pydata.org/">
    Seaborn
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://huggingface.co/">
    Hugging Face
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.kaggle.com/">
    Kaggle
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/cornel05/AI-Learning-Labs" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/dcornel05" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/cornel-ai" title="LinkedIn" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i>
            <span class="sr-only">LinkedIn</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Real-World Examples and Demos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../diamond_price_prediction/diamond_price_prediction.html">Diamond Price Prediction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Simple Linear Regression</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Regression</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Simple...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simple-linear-regression">
<h1>Simple Linear Regression<a class="headerlink" href="#simple-linear-regression" title="Link to this heading">#</a></h1>
<p><a name='1'></a></p>
<section id="id1">
<h2>1 - Simple Linear Regression<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><a name='1.1'></a></p>
<section id="simple-linear-regression-model">
<h3>- Simple Linear Regression Model<a class="headerlink" href="#simple-linear-regression-model" title="Link to this heading">#</a></h3>
<p>You can describe a simple linear regression model as</p>
<div class="math notranslate nohighlight">
\[\hat{y} = wx + b,\tag{1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{y}\)</span> is a prediction of dependent variable <span class="math notranslate nohighlight">\(y\)</span> based on independent variable <span class="math notranslate nohighlight">\(x\)</span> using a line equation with the slope <span class="math notranslate nohighlight">\(w\)</span> and intercept <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>Given a set of training data points <span class="math notranslate nohighlight">\((x_1, y_1)\)</span>, …, <span class="math notranslate nohighlight">\((x_m, y_m)\)</span>, you will find the “best” fitting line - such parameters <span class="math notranslate nohighlight">\(w\)</span> and <span class="math notranslate nohighlight">\(b\)</span> that the differences between original values <span class="math notranslate nohighlight">\(y_i\)</span> and predicted values <span class="math notranslate nohighlight">\(\hat{y}_i = wx_i + b\)</span> are minimum.</p>
<p><a name='1.2'></a></p>
</section>
<section id="neural-network-model-with-a-single-perceptron-and-one-input-node">
<h3>- Neural Network Model with a Single Perceptron and One Input Node<a class="headerlink" href="#neural-network-model-with-a-single-perceptron-and-one-input-node" title="Link to this heading">#</a></h3>
<p>The simplest neural network model that describes the above problem can be realized by using one <strong>perceptron</strong>. The <strong>input</strong> and <strong>output</strong> layers will have one <strong>node</strong> each (<span class="math notranslate nohighlight">\(x\)</span> for input and <span class="math notranslate nohighlight">\(\hat{y} = z\)</span> for output):</p>
<!-- ![Single perceptron](images/nn_model_linear_regression_simple.png){width=400px} -->
<figure class="align-default" id="nn-model-linear-regression-simple">
<a class="reference internal image-reference" href="../../../_images/nn_model_linear_regression_simple.png"><img alt="../../../_images/nn_model_linear_regression_simple.png" src="../../../_images/nn_model_linear_regression_simple.png" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-text">Single perceptron</span><a class="headerlink" href="#nn-model-linear-regression-simple" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Weight</strong> (<span class="math notranslate nohighlight">\(w\)</span>) and <strong>bias</strong> (<span class="math notranslate nohighlight">\(b\)</span>) are the parameters that will get updated when you <strong>train</strong> the model. They are initialized to some random values or set to 0 and updated as the training progresses.</p>
<p>For each training example <span class="math notranslate nohighlight">\(x^{(i)}\)</span>, the prediction <span class="math notranslate nohighlight">\(\hat{y}^{(i)}\)</span> can be calculated as:</p>
<div class="math notranslate nohighlight">
\[
z^{(i)} =  w x^{(i)} + b
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{y}^{(i)} = z^{(i)}
\tag{2}
\]</div>
<p>where <span class="math notranslate nohighlight">\(i = 1, \dots, m\)</span>.</p>
<p>You can organise all training examples as a vector <span class="math notranslate nohighlight">\(X\)</span> of size (<span class="math notranslate nohighlight">\(1 \times m\)</span>) and perform scalar multiplication of <span class="math notranslate nohighlight">\(X\)</span> (<span class="math notranslate nohighlight">\(1 \times m\)</span>) by a scalar <span class="math notranslate nohighlight">\(w\)</span>, adding <span class="math notranslate nohighlight">\(b\)</span>, which will be broadcasted to a vector of size (<span class="math notranslate nohighlight">\(1 \times m\)</span>):</p>
<div class="math notranslate nohighlight">
\[
Z =  w X + b
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{Y} = Z
\tag{3}
\]</div>
<p>This set of calculations is called <strong>forward propagation</strong>.</p>
<p>For each training example you can measure the difference between original values <span class="math notranslate nohighlight">\(y^{(i)}\)</span> and predicted values <span class="math notranslate nohighlight">\(\hat{y}^{(i)}\)</span> with the <strong>loss function</strong> <span class="math notranslate nohighlight">\(L\left(w, b\right)  = \frac{1}{2}\left(\hat{y}^{(i)} - y^{(i)}\right)^2\)</span>. Division by <span class="math notranslate nohighlight">\(2\)</span> is taken just for scaling purposes, you will see the reason below, calculating partial derivatives. To compare the resulting vector of the predictions <span class="math notranslate nohighlight">\(\hat{Y}\)</span> (<span class="math notranslate nohighlight">\(1 \times m\)</span>) with the vector <span class="math notranslate nohighlight">\(Y\)</span> of original values <span class="math notranslate nohighlight">\(y^{(i)}\)</span>, you can take an average of the loss function values for each of the training examples:</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L}\left(w, b\right)  = \frac{1}{2m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)^2
\tag{4}
\]</div>
<p>This function is called the sum of squares <strong>cost function</strong>. The aim is to optimize the cost function during the training, which will minimize the differences between original values <span class="math notranslate nohighlight">\(y^{(i)}\)</span> and predicted values <span class="math notranslate nohighlight">\(\hat{y}^{(i)}\)</span>.</p>
<p>When your weights were just initialized with some random values, and no training was done yet, you can’t expect good results. You need to calculate the adjustments for the weight and bias, minimizing the cost function. This process is called <strong>backward propagation</strong>.</p>
<p>According to the gradient descent algorithm, you can calculate partial derivatives as:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L} }{ \partial w } = 
\frac{1}{m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)x^{(i)}
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L} }{ \partial b } = 
\frac{1}{m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)
\tag{5}
\]</div>
<p>You can see how the additional division by <span class="math notranslate nohighlight">\(2\)</span> in the equation <span class="math notranslate nohighlight">\((4)\)</span> helped to simplify the results of the partial derivatives. Then update the parameters iteratively using the expressions</p>
<div class="math notranslate nohighlight">
\[
w = w - \alpha \frac{\partial \mathcal{L} }{ \partial w }
\]</div>
<div class="math notranslate nohighlight">
\[
b = b - \alpha \frac{\partial \mathcal{L} }{ \partial b }
\tag{6}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the learning rate. Then repeat the process until the cost function stops decreasing.</p>
<p>The general <strong>methodology</strong> to build a neural network is to:</p>
<ol class="arabic simple">
<li><p>Define the neural network structure ( # of input units,  # of hidden units, etc).</p></li>
<li><p>Initialize the model’s parameters</p></li>
<li><p>Loop:</p>
<ul class="simple">
<li><p>Implement forward propagation (calculate the perceptron output),</p></li>
<li><p>Implement backward propagation (to get the required corrections for the parameters),</p></li>
<li><p>Update parameters.</p></li>
</ul>
</li>
<li><p>Make predictions.</p></li>
</ol>
<p>You often build helper functions to compute steps 1-3 and then merge them into one function <code class="docutils literal notranslate"><span class="pre">nn_model()</span></code>. Once you’ve built <code class="docutils literal notranslate"><span class="pre">nn_model()</span></code> and learnt the right parameters, you can make predictions on new data.</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import all the required packages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="c1"># A library for data manipulation and analysis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Output of plotting commands is displayed within the Jupyter notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Set a seed so that the results are consistent accross sessions.</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Link to this heading">#</a></h3>
<p>Load the <a class="reference external" href="https://www.kaggle.com/code/devzohaib/simple-linear-regression/notebook">Kaggle dataset</a>, saved in <code class="docutils literal notranslate"><span class="pre">../data/tvmarketing.csv</span></code>. It has two fields: TV marketing expenses (<code class="docutils literal notranslate"><span class="pre">TV</span></code>) and sales amount (<code class="docutils literal notranslate"><span class="pre">Sales</span></code>).</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/tvmarketing.csv&#39;</span>
<span class="n">adv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Print some part of the dataset</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adv</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TV</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>230.1</td>
      <td>22.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44.5</td>
      <td>10.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17.2</td>
      <td>9.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>151.5</td>
      <td>18.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>180.8</td>
      <td>12.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<p>Plot the data points to see how they are distributed. You can use <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> function from <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> module.</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;TV&#39;, ylabel=&#39;Sales&#39;&gt;
</pre></div>
</div>
<img alt="../../../_images/128ce78ff30a41b81706bde154360c62a9e1c43b6f0157ef68bbb423c9ae3513.png" src="../../../_images/128ce78ff30a41b81706bde154360c62a9e1c43b6f0157ef68bbb423c9ae3513.png" />
</div>
</details>
</div>
<p>Normalize the data by subtracting the mean and dividing by the standard deviation. This will help the model to converge faster during training, and to avoid different units of measurement in the input data.</p>
<p>Normalized data have mean 0 and standard deviation 1. The following cell performs column-wise normalization of the dataset:</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adv_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">adv</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">adv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">adv</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># As omitting axis for np.std() is depracated, to avoid error, we must pass axis</span>
<span class="n">adv_norm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TV</th>
      <th>Sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.969852</td>
      <td>1.552053</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.197376</td>
      <td>-0.696046</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.516155</td>
      <td>-0.907406</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.052050</td>
      <td>0.860330</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.394182</td>
      <td>-0.215683</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_norm</span> <span class="o">=</span> <span class="n">adv_norm</span><span class="p">[</span><span class="s1">&#39;TV&#39;</span><span class="p">]</span> <span class="c1"># type pd.Series</span>
<span class="n">Y_norm</span> <span class="o">=</span> <span class="n">adv_norm</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span> <span class="c1"># type pd.Series</span>

<span class="c1"># Convert to np.array first to be able to reshape</span>
<span class="n">X_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_norm</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_norm</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X_norm</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Y_norm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((1, 200), (1, 200))
</pre></div>
</div>
</div>
</details>
</div>
<p>Plot the data points to see how they are distributed.</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adv_norm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;TV&#39;, ylabel=&#39;Sales&#39;&gt;
</pre></div>
</div>
<img alt="../../../_images/5841ef73637e957c70978aa39be2ba26eb77d37d916e254c033e6461e656daea.png" src="../../../_images/5841ef73637e957c70978aa39be2ba26eb77d37d916e254c033e6461e656daea.png" />
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">layer_sizes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arguments:</span>
<span class="sd">    X -- input dataset of shape (input size, number of examples)</span>
<span class="sd">    Y -- labels of shape (output size, number of examples)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    n_x -- the size of the input layer</span>
<span class="sd">    n_y -- the size of the output layer</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>

<span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span> <span class="o">=</span> <span class="n">layer_sizes</span><span class="p">(</span><span class="n">X_norm</span><span class="p">,</span> <span class="n">Y_norm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 1
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initialize_parameters</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">    params -- python dictionary containing your parameters:</span>
<span class="sd">                    W -- weight matrix of shape (n_y, n_x)</span>
<span class="sd">                    b -- bias value set as a vector of shape (n_y, 1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_y</span><span class="p">,</span> <span class="n">n_x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.01</span> <span class="c1"># scales down with std of 0.01 to avoid large computations later on</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="n">W</span><span class="p">,</span>
              <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>
    
    <span class="k">return</span> <span class="n">params</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="n">initialize_parameters</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">],</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.01788628]] [[0.]]
</pre></div>
</div>
</div>
</details>
</div>
<p>Implement <code class="docutils literal notranslate"><span class="pre">forward_propagation()</span></code> following the equation <span class="math notranslate nohighlight">\((3)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
Z =  w X + b
\]</div>
<div class="math notranslate nohighlight">
\[
\hat{Y} = Z
\]</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">forward_propagation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Argument:</span>
<span class="sd">    X -- input data of size (n_x, m)</span>
<span class="sd">    parameters -- python dictionary containing your parameters (output of initialization function)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    Y_hat -- The output of size (n_y, m)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">W</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
    <span class="n">Y_hat</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">X</span> <span class="o">+</span> <span class="n">b</span>
    
    <span class="k">return</span> <span class="n">Y_hat</span>

<span class="n">Y_hat</span> <span class="o">=</span> <span class="n">forward_propagation</span><span class="p">(</span><span class="n">X_norm</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some element of predicted Y_hat values: &quot;</span><span class="p">,</span> <span class="n">Y_hat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some element of predicted Y_hat values:  [ 0.01734705 -0.02141661 -0.02711838  0.00093098  0.00705046]
</pre></div>
</div>
</div>
</details>
</div>
<p>Your weights were just initialized with some random values, so the model has not been trained yet.</p>
<p>Define a cost function <span class="math notranslate nohighlight">\((4)\)</span> which will be used to train the model:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}\left(w, b\right)  = \frac{1}{2m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)^2\]</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_cost</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the cost function as a sum of squares</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    Y_hat -- The output of the neural network of shape (n_y, number of examples)</span>
<span class="sd">    Y -- &quot;true&quot; labels vector of shape (n_y, number of examples)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    cost -- sum of squares scaled by 1/(2*number of examples)</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Number of examples</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Y_hat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Compute cost</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">Y_hat</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">cost</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cost = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">compute_cost</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span><span class="w"> </span><span class="n">Y_norm</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cost = 0.48616887080159704
</pre></div>
</div>
</div>
</details>
</div>
<p>Calculate partial derivatives as shown in <span class="math notranslate nohighlight">\((5)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L} }{ \partial w } = 
\frac{1}{m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)x^{(i)}
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{\partial \mathcal{L} }{ \partial b } = 
\frac{1}{m}\sum_{i=1}^{m} \left(\hat{y}^{(i)} - y^{(i)}\right)
\]</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">backward_propagation</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements the backward propagation, calculating gradients</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    Y_hat -- the output of the neural network of shape (n_y, number of examples)</span>
<span class="sd">    X -- input data of shape (n_x, number of examples)</span>
<span class="sd">    Y -- &quot;true&quot; labels vector of shape (n_y, number of examples)</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    grads -- python dictionary containing gradients with respect to different parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">dZ</span> <span class="o">=</span> <span class="n">Y_hat</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="n">dW</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">dZ</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dZ</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Sum over rows, and do not reduce dimensions. e.g. (n_y,) -&gt; (n_y, 1)</span>
    
    <span class="n">grads</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dW&quot;</span><span class="p">:</span> <span class="n">dW</span><span class="p">,</span>
             <span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="n">db</span><span class="p">}</span>
    
    <span class="k">return</span> <span class="n">grads</span>

<span class="n">grads</span> <span class="o">=</span> <span class="n">backward_propagation</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span> <span class="n">X_norm</span><span class="p">,</span> <span class="n">Y_norm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dW = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;dW&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;db = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">grads</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dW = [[-0.76433814]]
db = [[1.687539e-16]]
</pre></div>
</div>
</div>
</details>
</div>
<p>Update parameters as shown in <span class="math notranslate nohighlight">\((6)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
w = w - \alpha \frac{\partial \mathcal{L} }{ \partial w }
\]</div>
<div class="math notranslate nohighlight">
\[
b = b - \alpha \frac{\partial \mathcal{L} }{ \partial b }
\]</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">update_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates parameters using the gradient descent update rule</span>
<span class="sd">    </span>
<span class="sd">    Arguments:</span>
<span class="sd">    parameters -- python dictionary containing parameters </span>
<span class="sd">    grads -- python dictionary containing gradients </span>
<span class="sd">    learning_rate -- learning rate parameter for gradient descent</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    parameters -- python dictionary containing updated parameters </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">W</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grads</span><span class="p">[</span><span class="s2">&quot;dW&quot;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grads</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span>
    
    <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;W&quot;</span><span class="p">:</span> <span class="n">W</span><span class="p">,</span>
                  <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span>
    
    <span class="k">return</span> <span class="n">parameters</span>

<span class="n">updated_params</span> <span class="o">=</span> <span class="n">update_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W updated = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">updated_params</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b updated = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">updated_params</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>W updated = [[0.93509205]]
b updated = [[-2.0250468e-16]]
</pre></div>
</div>
</div>
</details>
</div>
<p>Put everything together in the function <code class="docutils literal notranslate"><span class="pre">nn_model()</span></code>.</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">nn_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">print_cost</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Arguments:</span>
<span class="sd">    X -- dataset of shape (n_x, number of examples)</span>
<span class="sd">    Y -- labels of shape (n_y, number of examples)</span>
<span class="sd">    num_iterations -- number of iterations in the loop</span>
<span class="sd">    learning_rate -- learning rate parameter for gradient descent</span>
<span class="sd">    print_cost -- if True, print the cost every iteration</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    parameters -- parameters learnt by the model. They can then be used to make predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span> <span class="o">=</span> <span class="n">layer_sizes</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">initialize_parameters</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">):</span>
        
        <span class="c1"># Forward propagation. Inputs: &quot;X, parameters&quot;. Output: &quot;Y_hat&quot;.</span>
        <span class="n">Y_hat</span> <span class="o">=</span> <span class="n">forward_propagation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        
        <span class="c1"># Cost function. Inputs: &quot;Y_hat, Y&quot;. Output: &quot;cost&quot;.</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">compute_cost</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        
        <span class="c1"># Backpropagation. Inputs: &quot;Y_hat, X, Y&quot;. Output: &quot;grads&quot;.</span>
        <span class="n">grads</span> <span class="o">=</span> <span class="n">backward_propagation</span><span class="p">(</span><span class="n">Y_hat</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
        
        <span class="c1"># Gradient descent parameter update. Inputs: &quot;parameters, grads, learning_rate&quot;. Output: &quot;parameters&quot;.</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">update_parameters</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">grads</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">print_cost</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cost after iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cost</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">parameters</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters_simple</span> <span class="o">=</span> <span class="n">nn_model</span><span class="p">(</span><span class="n">X_norm</span><span class="p">,</span> <span class="n">Y_norm</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">print_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameters_simple</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameters_simple</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]))</span>

<span class="n">W_simple</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span>
<span class="n">b_simple</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cost after iteration 0: 0.49659504037484803
Cost after iteration 1: 0.20616377720695983
Cost after iteration 2: 0.1945465266802443
Cost after iteration 3: 0.1940818366591757
Cost after iteration 4: 0.19406324905833294
Cost after iteration 5: 0.19406250555429921
Cost after iteration 6: 0.19406247581413788
Cost after iteration 7: 0.19406247462453144
Cost after iteration 8: 0.19406247457694714
Cost after iteration 9: 0.1940624745750438
Cost after iteration 10: 0.19406247457496764
Cost after iteration 11: 0.19406247457496462
Cost after iteration 12: 0.19406247457496448
Cost after iteration 13: 0.19406247457496448
Cost after iteration 14: 0.19406247457496448
Cost after iteration 15: 0.19406247457496448
Cost after iteration 16: 0.19406247457496448
Cost after iteration 17: 0.19406247457496448
Cost after iteration 18: 0.19406247457496448
Cost after iteration 19: 0.19406247457496448
Cost after iteration 20: 0.19406247457496448
Cost after iteration 21: 0.19406247457496448
Cost after iteration 22: 0.19406247457496448
Cost after iteration 23: 0.19406247457496448
Cost after iteration 24: 0.19406247457496448
Cost after iteration 25: 0.19406247457496448
Cost after iteration 26: 0.19406247457496448
Cost after iteration 27: 0.19406247457496448
Cost after iteration 28: 0.19406247457496448
Cost after iteration 29: 0.19406247457496448
W = [[0.78222442]]
b = [[-3.19744231e-16]]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
    
    <span class="c1"># Use the same mean and standard deviation of the original training array X.</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handling of X for normalization:</span>

<span class="sd">        - If X is a Pandas Series:</span>
<span class="sd">            np.mean(X) and np.std(X) return scalar values (shape ()), </span>
<span class="sd">            because a Series is essentially a 1D array of values. </span>
<span class="sd">            This case typically corresponds to having only one feature column.</span>
<span class="sd">            In this scenario, we store mean and std as scalars and normalize X_pred </span>
<span class="sd">            using these scalars, then reshape it to (1, len(X_pred)) so that it </span>
<span class="sd">            matches the expected shape for matrix multiplication with W.</span>

<span class="sd">        - If X is a Pandas DataFrame:</span>
<span class="sd">            np.mean(X) and np.std(X) return a Pandas Series containing </span>
<span class="sd">            column-wise means and standard deviations. Converting them to NumPy </span>
<span class="sd">            arrays produces a 1D vector of shape (n_features,). </span>
<span class="sd">            We reshape them to (n_features, 1) so they can be broadcasted </span>
<span class="sd">            correctly during normalization of X_pred. </span>
<span class="sd">            This case typically corresponds to having multiple feature columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="n">X_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">X_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">X_pred_norm</span> <span class="o">=</span> <span class="p">((</span><span class="n">X_pred</span> <span class="o">-</span> <span class="n">X_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">X_std</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_pred</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">X_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">X_pred_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_pred</span> <span class="o">-</span> <span class="n">X_mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">X_std</span>
        
    <span class="c1"># Make predictions</span>
    <span class="n">Y_pred_norm</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">X_pred_norm</span> <span class="o">+</span> <span class="n">b</span>
    
    <span class="c1"># Convert back using same mean and std of original training Y</span>
    <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">Y_pred_norm</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">Y_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">X_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">230.1</span><span class="p">,</span> <span class="mf">44.2</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">])</span>
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">adv</span><span class="p">[</span><span class="s2">&quot;TV&quot;</span><span class="p">],</span> <span class="n">adv</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">],</span> <span class="n">parameters_simple</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TV marketing expenses:</span><span class="se">\n</span><span class="si">{</span><span class="n">X_pred</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predictions of sales:</span><span class="se">\n</span><span class="si">{</span><span class="n">Y_pred</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TV marketing expenses:
[230.1  44.2   8.6]
Predictions of sales:
[17.97077451  9.13371306  7.44140866]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">adv</span><span class="p">[</span><span class="s2">&quot;TV&quot;</span><span class="p">],</span> <span class="n">adv</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$y$&quot;</span><span class="p">)</span>

<span class="n">X_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">adv</span><span class="p">[</span><span class="s2">&quot;TV&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">adv</span><span class="p">[</span><span class="s2">&quot;TV&quot;</span><span class="p">])</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">Y_line</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">adv</span><span class="p">[</span><span class="s2">&quot;TV&quot;</span><span class="p">],</span> <span class="n">adv</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">],</span> <span class="n">parameters_simple</span><span class="p">,</span> <span class="n">X_line</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_line</span><span class="p">,</span> <span class="n">Y_line</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">)</span> <span class="c1"># blue dots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<img alt="../../../_images/94f585166f75791ffb5ab0309a6620357767dcb58ffb4ac4282a537512ef1587.png" src="../../../_images/94f585166f75791ffb5ab0309a6620357767dcb58ffb4ac4282a537512ef1587.png" />
</div>
</details>
</div>
<p><a name='2'></a></p>
</section>
</section>
<section id="multiple-linear-regression">
<h2>2 - Multiple Linear Regression<a class="headerlink" href="#multiple-linear-regression" title="Link to this heading">#</a></h2>
<p><a name='2.1'></a></p>
<section id="neural-network-model-with-a-single-perceptron-and-two-input-nodes">
<h3>- Neural Network Model with a Single Perceptron and Two Input Nodes<a class="headerlink" href="#neural-network-model-with-a-single-perceptron-and-two-input-nodes" title="Link to this heading">#</a></h3>
<p>Let’s build a linear regression model for a Kaggle dataset <a class="reference external" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">House Prices</a>, saved in a file <code class="docutils literal notranslate"><span class="pre">..data/house_prices_train.csv</span></code>. You will use two fields - ground living area (<code class="docutils literal notranslate"><span class="pre">GrLivArea</span></code>, square feet) and rates of the overall quality of material and finish (<code class="docutils literal notranslate"><span class="pre">OverallQual</span></code>, 1-10) to predict sales price (<code class="docutils literal notranslate"><span class="pre">SalePrice</span></code>, dollars).</p>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;data/house_prices_train.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_multi</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">,</span> <span class="s1">&#39;OverallQual&#39;</span><span class="p">]]</span>
<span class="n">Y_multi</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>
<span class="n">X_multi</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Y_multi</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((1460, 2), (1460,))
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">X_multi</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Y_multi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GrLivArea</th>
      <th>OverallQual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1710</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1262</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1786</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1717</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2198</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>1647</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>2073</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>2340</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>1078</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1459</th>
      <td>1256</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 2 columns</p>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       208500
1       181500
2       223500
3       140000
4       250000
         ...  
1455    175000
1456    210000
1457    266500
1458    142125
1459    147500
Name: SalePrice, Length: 1460, dtype: int64
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_multi_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_multi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Y_multi_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y_multi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y_multi</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Y_multi</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_multi_norm</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Y_norm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((1460, 2), (1, 200))
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_multi_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_multi_norm</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">Y_multi_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y_multi_norm</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y_multi_norm</span><span class="p">)))</span>
<span class="n">X_norm</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Y_multi_norm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((1, 200), (1, 1460))
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_multi_norm</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">Y_multi_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.37033344 -0.48251191  0.51501256  0.38365915  1.2993257 ]
 [ 0.65147924 -0.07183611  0.65147924  0.65147924  1.3747946 ]] [ 0.34727322  0.00728832  0.53615372 -0.51528106  0.8698426 ]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters_multi</span> <span class="o">=</span> <span class="n">nn_model</span><span class="p">(</span><span class="n">X_multi_norm</span><span class="p">,</span> <span class="n">Y_multi_norm</span><span class="p">,</span> <span class="n">num_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">print_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">parameters_multi</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">parameters_multi</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;W: </span><span class="si">{</span><span class="n">parameters_multi</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> and b: </span><span class="si">{</span><span class="n">parameters_multi</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cost after iteration 0: 0.5142195119760039
Cost after iteration 1: 0.44862664805802294
Cost after iteration 2: 0.3962236237408893
Cost after iteration 3: 0.35322650244442194
Cost after iteration 4: 0.3176388968906906
Cost after iteration 5: 0.28810227675703015
Cost after iteration 6: 0.2635663230551014
Cost after iteration 7: 0.2431787775092655
Cost after iteration 8: 0.22623677631465744
Cost after iteration 9: 0.21215762854913936
Cost after iteration 10: 0.20045746930524147
Cost after iteration 11: 0.19073428857122826
Cost after iteration 12: 0.1826540289332285
Cost after iteration 13: 0.1759390850066516
Cost after iteration 14: 0.170358759895168
Cost after iteration 15: 0.1657213378223942
Cost after iteration 16: 0.16186749718900195
Cost after iteration 17: 0.15866483686740238
Cost after iteration 18: 0.1560033274486568
Cost after iteration 19: 0.1537915311054225
Cost after iteration 20: 0.1519534601860057
Cost after iteration 21: 0.15042596661037508
Cost after iteration 22: 0.14915657237810437
Cost after iteration 23: 0.14810166665369826
Cost after iteration 24: 0.1472250074889603
Cost after iteration 25: 0.14649647670811547
Cost after iteration 26: 0.14589104517897944
Cost after iteration 27: 0.14538791292141448
Cost after iteration 28: 0.14496979451095832
Cost after iteration 29: 0.1446223252272187
Cost after iteration 30: 0.14433356754488944
Cost after iteration 31: 0.1440936010125767
Cost after iteration 32: 0.14389418142946578
Cost after iteration 33: 0.1437284576106279
Cost after iteration 34: 0.1435907360102627
Cost after iteration 35: 0.14347628511635882
Cost after iteration 36: 0.1433811728966296
Cost after iteration 37: 0.14330213171107611
Cost after iteration 38: 0.1432364460501643
Cost after iteration 39: 0.14318185924179086
Cost after iteration 40: 0.1431364959218967
Cost after iteration 41: 0.14309879760515798
Cost after iteration 42: 0.14306746914224452
Cost after iteration 43: 0.14304143422415205
Cost after iteration 44: 0.1430197984049305
Cost after iteration 45: 0.1430018183724325
Cost after iteration 46: 0.1429868764113577
Cost after iteration 47: 0.14297445918125612
Cost after iteration 48: 0.14296414008039493
Cost after iteration 49: 0.142955564589588
Cost after iteration 50: 0.1429484380924669
Cost after iteration 51: 0.14294251575375058
Cost after iteration 52: 0.14293759410777576
Cost after iteration 53: 0.14293350406830627
Cost after iteration 54: 0.1429301051194693
Cost after iteration 55: 0.1429272804882445
Cost after iteration 56: 0.1429249331326534
Cost after iteration 57: 0.14292298240782159
Cost after iteration 58: 0.14292136129537322
Cost after iteration 59: 0.14292001410097277
Cost after iteration 60: 0.14291889454091114
Cost after iteration 61: 0.14291796415199975
Cost after iteration 62: 0.14291719097014374
Cost after iteration 63: 0.14291654843219517
Cost after iteration 64: 0.14291601446335958
Cost after iteration 65: 0.14291557071880256
Cost after iteration 66: 0.14291520195340132
Cost after iteration 67: 0.1429148954979891
Cost after iteration 68: 0.1429146408240979
Cost after iteration 69: 0.1429144291822463
Cost after iteration 70: 0.1429142533013457
Cost after iteration 71: 0.14291410713889743
Cost after iteration 72: 0.14291398567339883
Cost after iteration 73: 0.14291388473182634
Cost after iteration 74: 0.14291380084626906
Cost after iteration 75: 0.14291373113478598
Cost after iteration 76: 0.1429136732023953
Cost after iteration 77: 0.14291362505879346
Cost after iteration 78: 0.14291358504997667
Cost after iteration 79: 0.14291355180141707
Cost after iteration 80: 0.1429135241708394
Cost after iteration 81: 0.14291350120897797
Cost after iteration 82: 0.1429134821269635
Cost after iteration 83: 0.1429134662692215
Cost after iteration 84: 0.14291345309094916
Cost after iteration 85: 0.14291344213939877
Cost after iteration 86: 0.14291343303832293
Cost after iteration 87: 0.14291342547504843
Cost after iteration 88: 0.14291341918973427
Cost after iteration 89: 0.1429134139664445
Cost after iteration 90: 0.14291340962572974
Cost after iteration 91: 0.142913406018462
Cost after iteration 92: 0.14291340302071137
Cost after iteration 93: 0.14291340052948823
Cost after iteration 94: 0.142913398459205
Cost after iteration 95: 0.14291339673873585
Cost after iteration 96: 0.14291339530897298
Cost after iteration 97: 0.14291339412079596
Cost after iteration 98: 0.14291339313338425
Cost after iteration 99: 0.1429133923128147
W: [[0.3694604  0.57181575]] and b: [[1.21181604e-16]]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_multi_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1710</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">2200</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">Y_multi_pred</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">Y_multi</span><span class="p">,</span> <span class="n">parameters_multi</span><span class="p">,</span> <span class="n">X_multi_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground living area, square feet:</span><span class="se">\n</span><span class="si">{</span><span class="n">X_multi_pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rates of the overall quality of material and finish, 1-10:</span><span class="se">\n</span><span class="si">{</span><span class="n">X_multi_pred</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predictions of sales price, $:</span><span class="se">\n</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Y_multi_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ground living area, square feet:
[1710 1200 2200]
Rates of the overall quality of material and finish, 1-10:
[7 6 8]
Predictions of sales price, $:
[221371. 160039. 281587.]
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output tag_scroll-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure X_multi and Y_multi exist; if not, load</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">X_multi</span>
    <span class="n">Y_multi</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/house_prices_train.csv&#39;</span><span class="p">)</span>
    <span class="n">X_multi</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">,</span> <span class="s1">&#39;OverallQual&#39;</span><span class="p">]]</span>
    <span class="n">Y_multi</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SalePrice&#39;</span><span class="p">]</span>

<span class="c1"># Ensure trained parameters are available (no retraining here)</span>
<span class="k">if</span> <span class="s1">&#39;parameters_multi&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Trained parameters &#39;parameters_multi&#39; not found. Please run the training cell above first.&quot;</span><span class="p">)</span>

<span class="c1"># Build prediction grids while fixing the other feature at its mean (original scale)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">x2_fixed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">X_pred1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2_fixed</span><span class="p">)])</span>  <span class="c1"># shape (2, 200)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">Y_multi</span><span class="p">,</span> <span class="n">parameters_multi</span><span class="p">,</span> <span class="n">X_pred1</span><span class="p">)</span>

<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">x1_fixed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">X_pred2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">x1_fixed</span><span class="p">),</span> <span class="n">x2</span><span class="p">])</span>  <span class="c1"># shape (2, 200)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">X_multi</span><span class="p">,</span> <span class="n">Y_multi</span><span class="p">,</span> <span class="n">parameters_multi</span><span class="p">,</span> <span class="n">X_pred2</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Subplot 1: SalePrice vs GrLivArea</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;GrLivArea&#39;</span><span class="p">],</span> <span class="n">Y_multi</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;GrLivArea (sq ft)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SalePrice ($)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SalePrice vs GrLivArea&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="c1"># Subplot 2: SalePrice vs OverallQual</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_multi</span><span class="p">[</span><span class="s1">&#39;OverallQual&#39;</span><span class="p">],</span> <span class="n">Y_multi</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;OverallQual (1-10)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;SalePrice vs OverallQual&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;House Prices: Feature-wise Scatter with Predicted Lines&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<img alt="../../../_images/344a18228b4b4e64f5f8617b32c805524d0185f73bfcfe0e20bb29874a4e6459.png" src="../../../_images/344a18228b4b4e64f5f8617b32c805524d0185f73bfcfe0e20bb29874a4e6459.png" />
</div>
</details>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../diamond_price_prediction/diamond_price_prediction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diamond Price Prediction</p>
      </div>
    </a>
    <a class="right-next"
       href="../../optimization/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Optimization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1 - Simple Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-linear-regression-model">- Simple Linear Regression Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-model-with-a-single-perceptron-and-one-input-node">- Neural Network Model with a Single Perceptron and One Input Node</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-linear-regression">2 - Multiple Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-model-with-a-single-perceptron-and-two-input-nodes">- Neural Network Model with a Single Perceptron and Two Input Nodes</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/notebooks/regression/regression_with_single_perceptron/regression_with_single_perceptron.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, cornel @ AI Learning Labs.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__center">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>